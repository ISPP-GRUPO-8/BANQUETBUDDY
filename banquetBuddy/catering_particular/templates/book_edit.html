{% extends 'core/base.html' %}
{% load static %}

{% block content %}

<div class="container mt-4">
    <h1 class="card-title">Edit Event: {{ event.name }}</h1>
    <p class="card-title">Catering company: {{ event.cateringcompany.name }}</p>
    <form method="post" action="/my_books/{{ event.id }}/edit" id="bookingEditForm">
        {% csrf_token %}

        {% if error %}
            <div class="alert alert-danger" role="alert">
                {{ error }}
            </div>
        {% endif %}
        <div class="form-group">
            <label for="date">Event Date:</label>
            <input type="date" name="date" class="form-control" value="{{ event.date|date:'Y-m-d' }}" required>
        </div>

        <div class="form-group">
            <label for="number_guests">Number of Guests:</label>
            <input type="number" name="number_guests" class="form-control" value="{{ event.number_guests }}" required>
        </div>

        <div class="form-group">
            <label for="menu">Select Menu:</label>
            <div class="row">
                {% for menu in menus %}
                <div class="col-md-4 mb-4">
                  <div class="card h-100 d-flex flex-column shadow-sm custom-card-bg">
                    <div class="card-body flex-fill d-flex flex-column">
                      <h4 class="card-title">{{ menu.name }}</h4>
                      <p class="card-text">{{ menu.description }}</p>
                      <h5 class="card-subtitle mb-2 text-muted">Plates:</h5>
                        <ul>
                            {% for plate in menus_with_plates.items %}
                                {% if plate.0 == menu %}
                                    {% for p in plate.1 %}
                                        <li>{{ p.name }}: <span class="text-muted">{{ p.description }}</span></li>
                                    {% endfor %}
                                {% endif %}
                            {% endfor %}
                        </ul>
                      <div class="mt-auto">
                        <div class="btn-group">
                          <button type="button" class="btn btn-add select-menu"
                            data-menu-id="{{ menu.id }}">Select</button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                {% endfor %}
                <input type="hidden" name="selected_menu" id="selected_menu">
            </div>
            </br>
        </div>
        <div class="text-center">
            <button type="submit" class="btn btn-custom" form="bookingEditForm">Save Changes</button>
        </div>
        <p></p>
    </form>
</div>
<script>
  document.addEventListener('DOMContentLoaded', function () {
      const selectButtons = document.querySelectorAll('.select-menu');

      selectButtons.forEach(button => {
          button.addEventListener('click', function () {
              const menuId = this.getAttribute('data-menu-id');
              document.getElementById('selected_menu').value = menuId;
          });
      });
  });
  document.addEventListener('DOMContentLoaded', function () {
    const selectButtons = document.querySelectorAll('.select-menu');

    selectButtons.forEach(button => {
        button.addEventListener('click', function () {
            // Remover la clase 'btn-selected' de todos los botones
            selectButtons.forEach(btn => btn.classList.remove('btn-select'));

            // Agregar la clase 'btn-selected' al bot√≥n seleccionado
            this.classList.add('btn-select');

            const menuId = this.getAttribute('data-menu-id');
            document.getElementById('selected_menu').value = menuId;
        });
    });
});
</script>
<style>
    .btn-select {
        background-color: #02483E;
        border-color: #02483E;
        color: #ffffff;
    }
</style>
{% endblock %}